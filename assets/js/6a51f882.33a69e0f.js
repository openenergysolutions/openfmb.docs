"use strict";(self.webpackChunkopenfmb_docs=self.webpackChunkopenfmb_docs||[]).push([[9974],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),d=r,h=c["".concat(s,".").concat(d)]||c[d]||m[d]||o;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2378:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:2,sidebar_label:"Sample Extension"},i="How to Write an Extension",l={unversionedId:"adapter-extensions/sample",id:"adapter-extensions/sample",title:"How to Write an Extension",description:"The objective is to leverage our developed extension framework to establish communication with a fictional smart plug device that utilizes UDP protocol. This extension framework enables seamless integration of different protocol adapters written in various programming languages, facilitating efficient and flexible communication with such devices.",source:"@site/docs/adapter-extensions/sample.md",sourceDirName:"adapter-extensions",slug:"/adapter-extensions/sample",permalink:"/docs/adapter-extensions/sample",draft:!1,editUrl:"https://github.com/openenergysolutions/openfmb.docs/edit/develop/website/docs/adapter-extensions/sample.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Sample Extension"},sidebar:"tutorialSidebar",previous:{title:"OpenFMB Adapter Extension",permalink:"/docs/adapter-extensions/"},next:{title:"Release Notes",permalink:"/docs/releases/"}},s={},p=[{value:"Scenario 1",id:"scenario-1",level:2},{value:"Scenario 2",id:"scenario-2",level:2}],u={toc:p},c="wrapper";function m(e){let{components:t,...o}=e;return(0,r.kt)(c,(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-write-an-extension"},"How to Write an Extension"),(0,r.kt)("p",null,"The objective is to leverage our developed extension framework to establish communication with a fictional smart plug device that utilizes UDP protocol. This extension framework enables seamless integration of different protocol adapters written in various programming languages, facilitating efficient and flexible communication with such devices."),(0,r.kt)("p",null,"For a demonstration of the implementation, please refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/openenergysolutions/openfmb.adapters.udp"},"repository")," provided. The sample code available in the repository is the UDP OpenFMB Adapter, which is implemented in Rust programming language. This adapter leverages an ",(0,r.kt)("inlineCode",{parentName:"p"},"inside-container")," communication bus. When data is received from the fictional smart plug device, the UDP OpenFMB Adapter will publish a ",(0,r.kt)("inlineCode",{parentName:"p"},"SwitchStatusProfile")," indicating the plug's On/Off state, as well as a ",(0,r.kt)("inlineCode",{parentName:"p"},"SwitchReadingProfile")," providing voltage, current, and power measurements. Additionally, the UDP OpenFMB Adapter subscribes to the ",(0,r.kt)("inlineCode",{parentName:"p"},"SwitchDiscreteControlProfile"),", enabling it to turn the smart plug On/Off based on the received commands."),(0,r.kt)("h1",{id:"sources"},"Sources"),(0,r.kt)("p",null,"The sample of an adapter extension can be found in this ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/openenergysolutions/openfmb.adapters.ext"},"repository"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/openenergysolutions/openfmb.adapters.ext\n")),(0,r.kt)("p",null,"This repository contains Docker build files and examples to demonstrate how an adapter extension works.  See ",(0,r.kt)("inlineCode",{parentName:"p"},"examples")," directory below."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},".\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 build.sh\n\u251c\u2500\u2500 examples\n\u2502\xa0\xa0 \u251c\u2500\u2500 dnp3-master\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 adapter.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 docker-compose.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 template.yaml\n\u2502\xa0\xa0 \u251c\u2500\u2500 hmi\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 config\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 app.toml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 diagrams\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 25a5c7c3-486c-4956-8eb0-49617bfc46f8.json\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 docker-compose.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 equipment.json\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 users.json\n\u2502\xa0\xa0 \u251c\u2500\u2500 plug-simulator\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 config.json\n\u2502\xa0\xa0 \u251c\u2500\u2500 scenario-1\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 adapters\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bridge-adapter.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 udp-adapter.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 udp-template.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 docker-compose.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 launcher\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 config.yaml\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 tmp\n\u2502\xa0\xa0 \u2514\u2500\u2500 scenario-2\n\u2502\xa0\xa0     \u251c\u2500\u2500 adapters\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 bridge-adapter.yaml\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 dnp3-outstation-template.yaml\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 udp-adapter.yaml\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 udp-template.yaml\n\u2502\xa0\xa0     \u251c\u2500\u2500 docker-compose.yaml\n\u2502\xa0\xa0     \u251c\u2500\u2500 launcher\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 config.yaml\n\u2502\xa0\xa0     \u2514\u2500\u2500 tmp\n\u2514\u2500\u2500 replace-ip-address.sh\n")),(0,r.kt)("h1",{id:"docker-image"},"Docker Image"),(0,r.kt)("p",null,"Run the build script to build the Docker image:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./build.sh\n")),(0,r.kt)("p",null,"Or just pull from OES's Dockerhub:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull oesinc/openfmb.adapters.ext\n")),(0,r.kt)("h1",{id:"launcher-app"},"Launcher App"),(0,r.kt)("p",null,"Launcher is an app that acts as the entry point of the Docker image.  The following configuration is used by the Launcher:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"---\nlauncher:\n  log_level: Debug\nadapters: \n  - name: oes-plug\n    type: oes-plug\n    config: /adapters/udp-adapter.yaml\n  - name: bridge-master\n    type: pub-sub-bridge    \n    config: /adapters/bridge-adapter.yaml \n...\n")),(0,r.kt)("p",null,"The following adapter types (",(0,r.kt)("inlineCode",{parentName:"p"},"adapters.type"),") are supported by the launcher:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"dnp3-master (DNP3)"),(0,r.kt)("li",{parentName:"ul"},"dnp3-outstation (DNP3)"),(0,r.kt)("li",{parentName:"ul"},"modbus-master (MODBUS)"),(0,r.kt)("li",{parentName:"ul"},"modbus-outstation (MODBUS)"),(0,r.kt)("li",{parentName:"ul"},"pub-sub-bridge (bridging between pub/sub protocols such as NATS, MQTT, ZENOH, DDS**)"),(0,r.kt)("li",{parentName:"ul"},"oes-plug (the OES fictitious smart plug speaking UDP)*"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"ocpp-adapter (OCPP 1.6)**")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"iccp-client (IEC60870-6)**")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"iccp-server (IEC60870-6)**")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"IEC61850-client (IEC61850)**")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"IEC61850-server (IEC61850)**")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"openadr (OpenADR)**")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("i",null,"ieee2030.5 (IEEE 2030.5)**"))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"(*)  This sample plug-in/extension\n(**) Required appropriate licensing")),(0,r.kt)("h1",{id:"examples"},"Examples"),(0,r.kt)("p",null,"These examples are intented to be run on ",(0,r.kt)("b",null,"Linux OS.")),(0,r.kt)("p",null,"Before running the examples, run ",(0,r.kt)("inlineCode",{parentName:"p"},"replace-ip-address.sh")," script.  Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"<MY_COMPUTER_IP_ADDRESS>")," with your computer's IP address."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"HOST_IP_ADDRESS=<MY_COMPUTER_IP_ADDRESS> ./replace-ip-address.sh\n")),(0,r.kt)("p",null,"To demonstrate, consider these two scenarios:"),(0,r.kt)("h2",{id:"scenario-1"},"Scenario 1"),(0,r.kt)("p",null,"To be able to monitor the OES fictitious smart plug data, and turn it on/off using OpenFMB via NATS pub/sub protocol:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Note that the UDP OpenFMB Adapter doesn't support NATS.  We are utilizing the protocol-bridge functionality of the OpenFMB Adapter Framework extension")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9966).Z,width:"1314",height:"981"})),(0,r.kt)("p",null,"To run the adapters, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd examples/scenario-1\ndocker-compose up\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose")," command shall start:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"an UDP Plug simulator (software simulator of the OES fictitious smart plug)"),(0,r.kt)("li",{parentName:"ul"},"a NATS broker"),(0,r.kt)("li",{parentName:"ul"},"an UDP extension adapter")),(0,r.kt)("p",null,"Now, to monitor the smart plug as well as turn it ON/OFF, we can stand up an OES' Human Machine Interface (HMI) tool by running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd ../hmi\ndocker-compose up\n")),(0,r.kt)("h2",{id:"scenario-2"},"Scenario 2"),(0,r.kt)("p",null,"To be able to monitor the OES fictitious smart plug data and turn it on/off using DNP3 protocol"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"We are internally translating UDP datagram into DNP3"),(0,r.kt)("li",{parentName:"ul"},"The OpenFMB adapter acts as a DNP3 outstation to serve data to a connected DNP3 master program")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(4549).Z,width:"1322",height:"906"})),(0,r.kt)("p",null,"To run the adapters, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd examples/scenario-2\ndocker-compose up\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose")," command shall start:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"an UDP Plug simulator (software simulator of the OES fictitious smart plug)"),(0,r.kt)("li",{parentName:"ul"},"an UDP extension adapter exposes its data as a DNP3 outstation\n")),(0,r.kt)("p",null,"The DNP3 outstation data points:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Binary Input 0 for the plug status ON/OFF"),(0,r.kt)("li",{parentName:"ul"},"Binary Output 0 to turn the plug ON/OFF"),(0,r.kt)("li",{parentName:"ul"},"Analog Inputs: Current = 0; Voltage: 1; Power: 2")),(0,r.kt)("p",null,"To interrogate data, use a DNP3 master software to connect to the outstation:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"IP address: same as ",(0,r.kt)("inlineCode",{parentName:"li"},"<MY_COMPUTER_IP_ADDRESS>")," above"),(0,r.kt)("li",{parentName:"ul"},"Port: 20000"),(0,r.kt)("li",{parentName:"ul"},"Master Address: 1"),(0,r.kt)("li",{parentName:"ul"},"Outstation Address: 10")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"To monitor and control the smart plug, we can deploy OES' Human Machine Interface (HMI) tool. Additionally, we can set up a DNP3 Master OpenFMB Adapter, which establishes a connection with the outstation and publishes data on the NATS messaging system. This combination of tools allows for comprehensive monitoring of the smart plug's status and enables the ability to remotely toggle its power On/Off."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd ../dnp-master\ndocker-compose up -d\ncd ../hmi\ndocker-compose up\n"))),(0,r.kt)("h1",{id:"hmi-screen"},"HMI Screen"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(5427).Z,width:"846",height:"688"})))}m.isMDXComponent=!0},9966:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/openfmb-adapter-extensions-scenario-1-c315a5a18264a32ee0bbfe6d1ddfdc71.png"},4549:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/openfmb-adapter-extensions-scenario-2-0459961d2123df05e12e63c7cd2b323b.png"},5427:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/udp-hmi-demo-c46764bf49acce0b248adcb9ff3a7281.png"}}]);